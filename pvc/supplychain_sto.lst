GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                   06/05/18 16:06:14 Page 1
'pvc model for ANOR journal'
C o m p i l a t i o n


   2   
       
      PVC供应链模型：
      1）两个供应商 一个是用油制作原材料， 一个是用煤做原材料
      2）原材料一种
      3）工厂3个 (第三个工厂规模是第二个的一半)
      4）产品3种
      5) 运输模式3种
      6）仓库2个
      7) 客户2个                
  14   
  15  Set
  16   
  17     s 'supplier'              / PVC-oil,  PVC-calcium /
  18     f 'plant'                 / plant_1, plant_2, plant_3 /
  19     w 'warehouse'             / warehouse_1, warehouse_2 /
  20     c 'customer'              / customer_1, customer_2 /
  21     t 'transport mode'        / road,  rail, barge /
  22     p 'product'               / p_50, p_75, p_110 /
  23     ;
  24   
  25   
  26  Scalar cp       'carbon price (yuan),stohastic parameter, uniform distribution'   / 100 /
  27         lostper  '原材料生产成成品损耗系数，0.7代表 1吨原材能加工0.7吨成品'              / 0.7 /
  28      ;
  29   
  30  Parameter
  31     sem(s) 'CO2 emissions(ton) for puducting one ton raw material in supplier s'
  32     /
  33        PVC-oil      1.9
  34        PVC-calcium  7.5
  35     /
  36     scap(s) 'capacity (ton) of supplier s'
  37     /
  38        PVC-oil      90000
  39        PVC-calcium  120000
  40     /
  41     sprc(s) 'price (yuan) of one ton raw material for supplier s'
  42     /
  43        PVC-oil      7100
  44        PVC-calcium  6900
  45     /
  46   
  47     fcap(f) 'total capacity (ton) in plant f'
  48     /
  49        plant_1      67800
  50        plant_2      85000
  51        plant_3      42500
  52     /
  53    fce(f) 'annual fixed costs (yuan) of establishing plant f'
  54    /
  55        plant_1     7550000
  56        plant_2     9475000
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                   06/05/18 16:06:14 Page 2
'pvc model for ANOR journal'
C o m p i l a t i o n


  57        plant_3     4737500
  58    /
  59   
  60    pcep(p) 'Fixed costs(yuan) of producing one ton of product p'
  61    /
  62        p_50        700
  63        p_75        700
  64        p_110       700
  65    /
  66   
  67   wcap(w) 'total capacity (ton) in warehouse w'
  68     /
  69        warehouse_1      60000
  70        warehouse_2      80000
  71     /
  72   wce(w) 'annual fixed costs (yuan) of establishing warehouse w'
  73    /
  74        warehouse_1     2100000
  75        warehouse_2     2400000
  76    /
  77    wcep(w) 'Fixed costs(yuan) of producing one ton of any product'
  78    /
  79        warehouse_1        700
  80        warehouse_2        600
  81    /
  82   
  83   
  84  * (22/1.97)*1000
  85    pup(p) 'price (yuan) per ton of product p'
  86    /
  87        p_50         11168
  88        p_75         9726
  89        p_110        10134
  90    /
  91    pemp(p) 'CO2 emissions(ton) for producing one ton of product p'
  92    /
  93        p_50         0.00025
  94        p_75         0.00022
  95        p_110        0.00019
  96    /
  97   
  98    sfcost(s,f,t) 'shipping cost (yuan per km per ton) from supplier s to plant f in transport mode t'
  99    /
 100        PVC-oil          .plant_1    .road      .53
 101        PVC-oil          .plant_1    .rail      .15
 102        PVC-oil          .plant_1    .barge     .17
 103        PVC-oil          .plant_2    .road      .53
 104        PVC-oil          .plant_2    .rail      .15
 105        PVC-oil          .plant_2    .barge     .17
 106        PVC-oil          .plant_3    .road      .53
 107        PVC-oil          .plant_3    .rail      .15
 108        PVC-oil          .plant_3    .barge     .17
 109        PVC-calcium      .plant_1    .road      .53
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                   06/05/18 16:06:14 Page 3
'pvc model for ANOR journal'
C o m p i l a t i o n


 110        PVC-calcium      .plant_1    .rail      .15
 111        PVC-calcium      .plant_1    .barge     .17
 112        PVC-calcium      .plant_2    .road      .53
 113        PVC-calcium      .plant_2    .rail      .15
 114        PVC-calcium      .plant_2    .barge     .17
 115        PVC-calcium      .plant_3    .road      .53
 116        PVC-calcium      .plant_3    .rail      .15
 117        PVC-calcium      .plant_3    .barge     .17
 118    /
 119   
 120    fwcost(f,w,t) 'shipping cost (yuan per km per ton) from  plant f  to warehouse w in transport mode t'
 121    /
 122        plant_1    .warehouse_1      .road      .65
 123        plant_1    .warehouse_1      .rail      .32
 124        plant_1    .warehouse_1      .barge     .15
 125        plant_1    .warehouse_2      .road      .65
 126        plant_1    .warehouse_2      .rail      .32
 127        plant_1    .warehouse_2      .barge     .15
 128        plant_2    .warehouse_1      .road      .65
 129        plant_2    .warehouse_1      .rail      .32
 130        plant_2    .warehouse_1      .barge     .15
 131        plant_2    .warehouse_2      .road      .65
 132        plant_2    .warehouse_2      .rail      .32
 133        plant_2    .warehouse_2      .barge     .15
 134        plant_3    .warehouse_1      .road      .65
 135        plant_3    .warehouse_1      .rail      .32
 136        plant_3    .warehouse_1      .barge     .15
 137        plant_3    .warehouse_2      .road      .65
 138        plant_3    .warehouse_2      .rail      .32
 139        plant_3    .warehouse_2      .barge     .15
 140   
 141    /
 142   
 143    wccost(w,c,t) 'shipping cost (yuan per km per ton) from warehouse w to customer c in transport mode t'
 144    /
 145        warehouse_1  .customer_1    .road      .71
 146        warehouse_1  .customer_1    .rail      .33
 147        warehouse_1  .customer_1    .barge     .21
 148        warehouse_1  .customer_2    .road      .71
 149        warehouse_1  .customer_2    .rail      .33
 150        warehouse_1  .customer_2    .barge     .21
 151        warehouse_2  .customer_1    .road      .71
 152        warehouse_2  .customer_1    .rail      .33
 153        warehouse_2  .customer_1    .barge     .21
 154        warehouse_2  .customer_2    .road      .71
 155        warehouse_2  .customer_2    .rail      .33
 156        warehouse_2  .customer_2    .barge     .21
 157   
 158    /
 159   
 160    sfdis(s,f,t)    'distance (km) from supplier s to plant f in transport mode t'
 161    /
 162        PVC-oil          .plant_1    .road      300
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                   06/05/18 16:06:14 Page 4
'pvc model for ANOR journal'
C o m p i l a t i o n


 163        PVC-oil          .plant_1    .rail      600
 164        PVC-oil          .plant_1    .barge     900
 165        PVC-oil          .plant_2    .road      400
 166        PVC-oil          .plant_2    .rail      800
 167        PVC-oil          .plant_2    .barge     1200
 168        PVC-oil          .plant_3    .road      500
 169        PVC-oil          .plant_3    .rail      1000
 170        PVC-oil          .plant_3    .barge     1500
 171        PVC-calcium      .plant_1    .road      400
 172        PVC-calcium      .plant_1    .rail      800
 173        PVC-calcium      .plant_1    .barge     1200
 174        PVC-calcium      .plant_2    .road      500
 175        PVC-calcium      .plant_2    .rail      1000
 176        PVC-calcium      .plant_2    .barge     1500
 177        PVC-calcium      .plant_3    .road      600
 178        PVC-calcium      .plant_3    .rail      1200
 179        PVC-calcium      .plant_3    .barge     1800
 180    /
 181   
 182    fwdis(f,w,t) 'distance (km)  from  plant f  to warehouse w in transport mode t'
 183    /
 184        plant_1    .warehouse_1      .road      200
 185        plant_1    .warehouse_1      .rail      300
 186        plant_1    .warehouse_1      .barge     500
 187        plant_1    .warehouse_2      .road      300
 188        plant_1    .warehouse_2      .rail      400
 189        plant_1    .warehouse_2      .barge     600
 190        plant_2    .warehouse_1      .road      210
 191        plant_2    .warehouse_1      .rail      310
 192        plant_2    .warehouse_1      .barge     510
 193        plant_2    .warehouse_2      .road      310
 194        plant_2    .warehouse_2      .rail      410
 195        plant_2    .warehouse_2      .barge     610
 196        plant_3    .warehouse_1      .road      220
 197        plant_3    .warehouse_1      .rail      340
 198        plant_3    .warehouse_1      .barge     540
 199        plant_3    .warehouse_2      .road      240
 200        plant_3    .warehouse_2      .rail      360
 201        plant_3    .warehouse_2      .barge     560
 202    /
 203   
 204   
 205    wcdis(w,c,t) 'distance (km) from warehouse w to customer c in transport mode t'
 206    /
 207        warehouse_1  .customer_1    .road      100
 208        warehouse_1  .customer_1    .rail      300
 209        warehouse_1  .customer_1    .barge     600
 210        warehouse_1  .customer_2    .road      150
 211        warehouse_1  .customer_2    .rail      450
 212        warehouse_1  .customer_2    .barge     900
 213        warehouse_2  .customer_1    .road      110
 214        warehouse_2  .customer_1    .rail      330
 215        warehouse_2  .customer_1    .barge     660
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                   06/05/18 16:06:14 Page 5
'pvc model for ANOR journal'
C o m p i l a t i o n


 216        warehouse_2  .customer_2    .road      160
 217        warehouse_2  .customer_2    .rail      500
 218        warehouse_2  .customer_2    .barge     1000
 219    /
 220   
 221    tem(t) 'CO2 emissions(ton/(ton,km) in transport mode t'
 222    /
 223      road   .00007
 224      rail   .000035
 225      barge  .00004
 226    /
 227   
 228    dmcp(c,p) 'demand (tons) of product p of customer c'
 229    /
 230     customer_1  .p_50  19680
 231     customer_1  .p_75  34524
 232     customer_1  .p_110 14095
 233     customer_2  .p_50  25584
 234     customer_2  .p_75  25318
 235     customer_2  .p_110 10086
 236    /
 237  ;
 238   
 239  positive variable
 240   
 241   
 242  VRP(s,f) 'amount of raw material (tons) purchased from supplier s in plant f'
 243   
 244  VRSF(s,f,t) 'amount of raw material (tons) shipped from supplier s to  plant f with transport mode t'
 245   
 246  VPFW(p,f,w,t) 'amount of product p (tons) shipped from plant f to warehouse w with transport mode t'
 247   
 248  VPWC(p,w,c,t) 'amount of product p (tons) shipped from warehouse w  to customer c with transport mode t'
 249   
 250  VPS(p,f) 'amount of product p (tons) produced from plant f'
 251   
 252  ;
 253   
 254   
 255  *binary variable
 256   
 257  *VSB(s) '1 if supplier s is established, 0 otherwise'
 258   
 259  *VFB(f) '1 if plant f is established 0 otherwise'
 260   
 261  *VWB(w) '1 if warehouse w is established, 0 otherwise'
 262   
 263  *;
 264   
 265  variable
 266   
 267  z 'overall costs'
 268  sc 'cost of suppliers'
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                   06/05/18 16:06:14 Page 6
'pvc model for ANOR journal'
C o m p i l a t i o n


 269  pc 'cost of plants'
 270  pf 'profit of plants'
 271  icm 'income'
 272   
 273  ;
 274   
 275   
 276   
 277  *  1 sum((s,f), sprc(s)*VRP(s,f)*VFB(f))                             原材料购买成本
 278  *  2 sum((s,f), cp*sem(s)*VRP(s,f)*VSB(s))                            原材料生产二氧化碳排放成本
 279  *  3 sum((p,f), pcep(p)*VPS(p,f)*VFB(f))                             产品生产成本
 280  *  3a sum((p,f), cp*pemp(p)*VPS(p,f))                                  产品生产二氧化碳成本
 281  *  4 sum(f,fce(f)*VFB(f)）                                           建厂固定成本（已经按年折算）
 282  *  5 sum(w,wce(w)*VWB(w))                                            建仓库固定成本（已按年折算）
 283  *  6 sum((p,f,w,t), wcep(w)*VPFW(p,f,w,t)*VFB(f)*VWB(w))             产品库存成本
 284  *  7 sum((s,f,t),sfdis(s,f,t)*sfcost(s,f,t)* VRSF(s,f,t)*VSB(s))     运输成本: 原材料运输：从供应商到工厂
 285  *  8 sum((p,f,w,t),fwcost(f,w,t)*fwdis(f,w,t)*VPFW(p,f,w,t)*VFB(f)*VWB(w)) 运输成本:  成品运输：从工厂到仓库
 286  *  9 sum((p,w,c,t),wccost(w,c,t)*wcdis(w,c,t)*VPWC(p,w,c,t)*VWB(w))        运输成本:  成品运输：从仓库到客户
 287  *  10 sum((s,f,t),cp*tem(t)*sfdis(s,f,t)*VRSF(s,f,t)*VSB(s))            原材料运输二氧化碳排放：供应商到工厂
 288  *  11 sum((p,f,w,t),cp*tem(t)*fwdis(f,w,t)*VPFW(p,f,w,t)*VFB(f)*VWB(w)) 成品运输二氧化碳排放：从工厂到仓库
 289  *  12 sum((p,w,c,t),cp*tem(t)*wcdis(w,c,t)*VPWC(p,w,c,t)*VWB(w))        成品运输二氧化碳排放：从仓库到客户
 290   
 291  equation
 292   
 293  cost           'objective function'
 294   
 295  suppliercost   '供应商成本由  2 7 10 组成'
 296   
 297  plantcost      '工厂成本由   1  3 4 5 6 8 9 11 12 组成'
 298   
 299  income         '销售收入'
 300   
 301  profit         'profit of plants'
 302   
 303  row1(c,p)        '仓库运输到客户的产品量必须等于客户需求量 （假设Just in Time 库存模式）'
 304   
 305  row2(p,w)        '入库等于出库'
 306   
 307  row3(p)          '产量大于需求量'
 308   
 309  row4(f)          '对于所有工厂，原材料满足生产'
 310   
 311  row5(s)          '供应商最大产能约束'
 312   
 313  row6(f)          '工厂产能约束'
 314   
 315  row7(w)          '仓库容量约束'
 316  ;
 317   
 318   
 319  suppliercost .. sc =e= sum((s,f), cp*sem(s)*VRP(s,f))
 320                        +sum((s,f,t),sfdis(s,f,t)*sfcost(s,f,t)*VRSF(s,f,t))
 321                        +sum((s,f,t),cp*tem(t)*sfdis(s,f,t)*VRSF(s,f,t));
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                   06/05/18 16:06:14 Page 7
'pvc model for ANOR journal'
C o m p i l a t i o n


 322   
 323  plantcost..     pc =e= sum((s,f), sprc(s)*VRP(s,f))
 324                        +sum((p,f), pcep(p)*VPS(p,f))
 325                        +sum((p,f), cp*pemp(p)*VPS(p,f))
 326                        +sum(f, fce(f))
 327                        +sum(w, wce(w))
 328                        +sum((p,f,w,t), wcep(w)*VPFW(p,f,w,t))
 329                        +sum((p,f,w,t),fwcost(f,w,t)*fwdis(f,w,t)*VPFW(p,f,w,t))
 330                        +sum((p,w,c,t),wccost(w,c,t)*wcdis(w,c,t)*VPWC(p,w,c,t))
 331                        +sum((p,f,w,t),cp*tem(t)*fwdis(f,w,t)*VPFW(p,f,w,t))
 332                        +sum((p,w,c,t),cp*tem(t)*wcdis(w,c,t)*VPWC(p,w,c,t));
 333   
 334  cost ..         z =e=  sc + pc;
 335   
 336  income..        icm =e= sum((p,f), pup(p)*VPS(p,f));
 337   
 338  profit ..       pf =e=  icm-pc;
 339   
 340  row1(c,p)..     dmcp(c,p) =e= sum((w,t),VPWC(p,w,c,t));
 341   
 342  row2(p,w)..    sum((c,t),VPWC(p,w,c,t)) =e= sum((f,t),VPFW(p,f,w,t));
 343   
 344  row3(p)..       sum(f, VPS(p,f)) =g= sum(c, dmcp(c,p));
 345   
 346  row4(f) ..      sum(s,lostper*VRP(s,f)) =g= sum(p,VPS(p,f));
 347   
 348  row5(s)..       scap(s) =g= sum(f,VRP(s,f));
 349   
 350  row6(f)..       fcap(f) =g= sum((p,w,t), VPFW(p,f,w,t));
 351   
 352  row7(w)..       wcap(w) =g= sum((p,f,t), VPFW(p,f,w,t));
 353   
 354   
 355  Model supplychain / ALL /;
 356   
 357   
 358  *sample  cp 6 method2
 359  file emp / '/Users/renhongtao/gamsmodel/pvc/pvc/225a/empinfo.dat'/; put emp '* problem /Users/renhongtao/gamsmodel/pvc/pvc/supplychain_sto.gms' /;
 360  $onput
 361  randvar cp uniform 0 30
 362  stage 2 cp suppliercost plantcost cost income profit
 363  $offput
 364  * Lindo can handle continuous distributions directly
 365  * For other EMPSP solvers cp need to be sampled aqead of time
 366  put 'sample cp 6';
 367  putclose emp;
 368   
 369   
 370  Set scen        scenarios / s1*s36 /;
 371  Parameter
 372      s_cp(scen)
 373      s_z(scen)
 374      s_pf(scen)
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                   06/05/18 16:06:14 Page 8
'pvc model for ANOR journal'
C o m p i l a t i o n


 375      s_o(scen,*)  scenario probability /#scen.prob 0 /;
 376   
 377  Set dict / scen .scenario.''
 378             cp   .randvar .s_cp
 379             z    .level   .s_z
 380             pf   .level   .s_pf
 381             ''   .opt     .s_o /;
 382   
 383  solve supplychain minimizing z use emp scenario dict;
 384   
 385  display s_cp, s_z, s_pf, s_o;
 386   
 387   
 388   


COMPILATION TIME     =        0.002 SECONDS      3 MB  24.9.2 r64480 DEX-DEG
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                   06/05/18 16:06:14 Page 9
'pvc model for ANOR journal'
Equation Listing    SOLVE supplychain Using EMP From line 383


---- cost  =E=  objective function

cost..  z - sc - pc =E= 0 ; (LHS = 0)
     

---- suppliercost  =E=  供应商成本由  2 7 10 组成

suppliercost..  - (190)*VRP(PVC-oil,plant_1) - (190)*VRP(PVC-oil,plant_2) - (190)*VRP(PVC-oil,plant_3) - (750)*VRP(PVC-calcium,plant_1) - (750)*VRP(PVC-calcium,plant_2) - (750)*VRP(PVC-calcium,plant_3) - (161.1)*VRSF(PVC-oil,plant_1,road)
     
      - (92.1)*VRSF(PVC-oil,plant_1,rail) - (156.6)*VRSF(PVC-oil,plant_1,barge) - (214.8)*VRSF(PVC-oil,plant_2,road) - (122.8)*VRSF(PVC-oil,plant_2,rail) - (208.8)*VRSF(PVC-oil,plant_2,barge) - (268.5)*VRSF(PVC-oil,plant_3,road)
     
      - (153.5)*VRSF(PVC-oil,plant_3,rail) - (261)*VRSF(PVC-oil,plant_3,barge) - (214.8)*VRSF(PVC-calcium,plant_1,road) - (122.8)*VRSF(PVC-calcium,plant_1,rail) - (208.8)*VRSF(PVC-calcium,plant_1,barge) - (268.5)*VRSF(PVC-calcium,plant_2,road)
     
      - (153.5)*VRSF(PVC-calcium,plant_2,rail) - (261)*VRSF(PVC-calcium,plant_2,barge) - (322.2)*VRSF(PVC-calcium,plant_3,road) - (184.2)*VRSF(PVC-calcium,plant_3,rail) - (313.2)*VRSF(PVC-calcium,plant_3,barge) + sc + (0)*cp_var =E= 0 ; (LHS = 0)
     

---- plantcost  =E=  工厂成本由   1  3 4 5 6 8 9 11 12 组成

plantcost..  - 7100*VRP(PVC-oil,plant_1) - 7100*VRP(PVC-oil,plant_2) - 7100*VRP(PVC-oil,plant_3) - 6900*VRP(PVC-calcium,plant_1) - 6900*VRP(PVC-calcium,plant_2) - 6900*VRP(PVC-calcium,plant_3) - (831.4)*VPFW(p_50,plant_1,warehouse_1,road)
     
      - (797.05)*VPFW(p_50,plant_1,warehouse_1,rail) - (777)*VPFW(p_50,plant_1,warehouse_1,barge) - (797.1)*VPFW(p_50,plant_1,warehouse_2,road) - (729.4)*VPFW(p_50,plant_1,warehouse_2,rail) - (692.4)*VPFW(p_50,plant_1,warehouse_2,barge)
     
      - (837.97)*VPFW(p_50,plant_2,warehouse_1,road) - (800.285)*VPFW(p_50,plant_2,warehouse_1,rail) - (778.54)*VPFW(p_50,plant_2,warehouse_1,barge) - (803.67)*VPFW(p_50,plant_2,warehouse_2,road) - (732.635)*VPFW(p_50,plant_2,warehouse_2,rail)
     
      - (693.94)*VPFW(p_50,plant_2,warehouse_2,barge) - (844.54)*VPFW(p_50,plant_3,warehouse_1,road) - (809.99)*VPFW(p_50,plant_3,warehouse_1,rail) - (783.16)*VPFW(p_50,plant_3,warehouse_1,barge) - (757.68)*VPFW(p_50,plant_3,warehouse_2,road)
     
      - (716.46)*VPFW(p_50,plant_3,warehouse_2,rail) - (686.24)*VPFW(p_50,plant_3,warehouse_2,barge) - (831.4)*VPFW(p_75,plant_1,warehouse_1,road) - (797.05)*VPFW(p_75,plant_1,warehouse_1,rail) - (777)*VPFW(p_75,plant_1,warehouse_1,barge)
     
      - (797.1)*VPFW(p_75,plant_1,warehouse_2,road) - (729.4)*VPFW(p_75,plant_1,warehouse_2,rail) - (692.4)*VPFW(p_75,plant_1,warehouse_2,barge) - (837.97)*VPFW(p_75,plant_2,warehouse_1,road) - (800.285)*VPFW(p_75,plant_2,warehouse_1,rail)
     
      - (778.54)*VPFW(p_75,plant_2,warehouse_1,barge) - (803.67)*VPFW(p_75,plant_2,warehouse_2,road) - (732.635)*VPFW(p_75,plant_2,warehouse_2,rail) - (693.94)*VPFW(p_75,plant_2,warehouse_2,barge) - (844.54)*VPFW(p_75,plant_3,warehouse_1,road)
     
      - (809.99)*VPFW(p_75,plant_3,warehouse_1,rail) - (783.16)*VPFW(p_75,plant_3,warehouse_1,barge) - (757.68)*VPFW(p_75,plant_3,warehouse_2,road) - (716.46)*VPFW(p_75,plant_3,warehouse_2,rail) - (686.24)*VPFW(p_75,plant_3,warehouse_2,barge)
     
      - (831.4)*VPFW(p_110,plant_1,warehouse_1,road) - (797.05)*VPFW(p_110,plant_1,warehouse_1,rail) - (777)*VPFW(p_110,plant_1,warehouse_1,barge) - (797.1)*VPFW(p_110,plant_1,warehouse_2,road) - (729.4)*VPFW(p_110,plant_1,warehouse_2,rail)
     
      - (692.4)*VPFW(p_110,plant_1,warehouse_2,barge) - (837.97)*VPFW(p_110,plant_2,warehouse_1,road) - (800.285)*VPFW(p_110,plant_2,warehouse_1,rail) - (778.54)*VPFW(p_110,plant_2,warehouse_1,barge) - (803.67)*VPFW(p_110,plant_2,warehouse_2,road)
     
      - (732.635)*VPFW(p_110,plant_2,warehouse_2,rail) - (693.94)*VPFW(p_110,plant_2,warehouse_2,barge) - (844.54)*VPFW(p_110,plant_3,warehouse_1,road) - (809.99)*VPFW(p_110,plant_3,warehouse_1,rail) - (783.16)*VPFW(p_110,plant_3,warehouse_1,barge)
     
      - (757.68)*VPFW(p_110,plant_3,warehouse_2,road) - (716.46)*VPFW(p_110,plant_3,warehouse_2,rail) - (686.24)*VPFW(p_110,plant_3,warehouse_2,barge) - (71.7)*VPWC(p_50,warehouse_1,customer_1,road) - (100.05)*VPWC(p_50,warehouse_1,customer_1,rail)
     
      - (128.4)*VPWC(p_50,warehouse_1,customer_1,barge) - (107.55)*VPWC(p_50,warehouse_1,customer_2,road) - (150.075)*VPWC(p_50,warehouse_1,customer_2,rail) - (192.6)*VPWC(p_50,warehouse_1,customer_2,barge) - (78.87)*VPWC(p_50,warehouse_2,customer_1,road)
     
      - (110.055)*VPWC(p_50,warehouse_2,customer_1,rail) - (141.24)*VPWC(p_50,warehouse_2,customer_1,barge) - (114.72)*VPWC(p_50,warehouse_2,customer_2,road) - (166.75)*VPWC(p_50,warehouse_2,customer_2,rail) - (214)*VPWC(p_50,warehouse_2,customer_2,barge)
     
      - (71.7)*VPWC(p_75,warehouse_1,customer_1,road) - (100.05)*VPWC(p_75,warehouse_1,customer_1,rail) - (128.4)*VPWC(p_75,warehouse_1,customer_1,barge) - (107.55)*VPWC(p_75,warehouse_1,customer_2,road) - (150.075)*VPWC(p_75,warehouse_1,customer_2,rail)
     
      - (192.6)*VPWC(p_75,warehouse_1,customer_2,barge) - (78.87)*VPWC(p_75,warehouse_2,customer_1,road) - (110.055)*VPWC(p_75,warehouse_2,customer_1,rail) - (141.24)*VPWC(p_75,warehouse_2,customer_1,barge)
     
      - (114.72)*VPWC(p_75,warehouse_2,customer_2,road) - (166.75)*VPWC(p_75,warehouse_2,customer_2,rail) - (214)*VPWC(p_75,warehouse_2,customer_2,barge) - (71.7)*VPWC(p_110,warehouse_1,customer_1,road) - (100.05)*VPWC(p_110,warehouse_1,customer_1,rail)
     
      - (128.4)*VPWC(p_110,warehouse_1,customer_1,barge) - (107.55)*VPWC(p_110,warehouse_1,customer_2,road) - (150.075)*VPWC(p_110,warehouse_1,customer_2,rail) - (192.6)*VPWC(p_110,warehouse_1,customer_2,barge)
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                  06/05/18 16:06:14 Page 10
'pvc model for ANOR journal'
Equation Listing    SOLVE supplychain Using EMP From line 383


     plantcost  =E=  工厂成本由   1  3 4 5 6 8 9 11 12 组成     
     
      - (78.87)*VPWC(p_110,warehouse_2,customer_1,road) - (110.055)*VPWC(p_110,warehouse_2,customer_1,rail) - (141.24)*VPWC(p_110,warehouse_2,customer_1,barge) - (114.72)*VPWC(p_110,warehouse_2,customer_2,road)
     
      - (166.75)*VPWC(p_110,warehouse_2,customer_2,rail) - (214)*VPWC(p_110,warehouse_2,customer_2,barge) - (700.025)*VPS(p_50,plant_1) - (700.025)*VPS(p_50,plant_2) - (700.025)*VPS(p_50,plant_3) - (700.022)*VPS(p_75,plant_1) - (700.022)*VPS(p_75,plant_2)
     
      - (700.022)*VPS(p_75,plant_3) - (700.019)*VPS(p_110,plant_1) - (700.019)*VPS(p_110,plant_2) - (700.019)*VPS(p_110,plant_3) + pc + (0)*cp_var =E= 26262500 ; (LHS = 0, INFES = 26262500 ****)
     

---- income  =E=  销售收入

income..  - 11168*VPS(p_50,plant_1) - 11168*VPS(p_50,plant_2) - 11168*VPS(p_50,plant_3) - 9726*VPS(p_75,plant_1) - 9726*VPS(p_75,plant_2) - 9726*VPS(p_75,plant_3) - 10134*VPS(p_110,plant_1) - 10134*VPS(p_110,plant_2) - 10134*VPS(p_110,plant_3) + icm =E= 0
      ; (LHS = 0)
     

---- profit  =E=  profit of plants

profit..  pc + pf - icm =E= 0 ; (LHS = 0)
     

---- row1  =E=  仓库运输到客户的产品量必须等于客户需求量 （假设Just in Time 库存模式）

row1(customer_1,p_50)..  - VPWC(p_50,warehouse_1,customer_1,road) - VPWC(p_50,warehouse_1,customer_1,rail) - VPWC(p_50,warehouse_1,customer_1,barge) - VPWC(p_50,warehouse_2,customer_1,road) - VPWC(p_50,warehouse_2,customer_1,rail)
     
      - VPWC(p_50,warehouse_2,customer_1,barge) =E= -19680 ; (LHS = 0, INFES = 19680 ****)
     
row1(customer_1,p_75)..  - VPWC(p_75,warehouse_1,customer_1,road) - VPWC(p_75,warehouse_1,customer_1,rail) - VPWC(p_75,warehouse_1,customer_1,barge) - VPWC(p_75,warehouse_2,customer_1,road) - VPWC(p_75,warehouse_2,customer_1,rail)
     
      - VPWC(p_75,warehouse_2,customer_1,barge) =E= -34524 ; (LHS = 0, INFES = 34524 ****)
     
row1(customer_1,p_110)..  - VPWC(p_110,warehouse_1,customer_1,road) - VPWC(p_110,warehouse_1,customer_1,rail) - VPWC(p_110,warehouse_1,customer_1,barge) - VPWC(p_110,warehouse_2,customer_1,road) - VPWC(p_110,warehouse_2,customer_1,rail)
     
      - VPWC(p_110,warehouse_2,customer_1,barge) =E= -14095 ; (LHS = 0, INFES = 14095 ****)
     
REMAINING 3 ENTRIES SKIPPED


---- row2  =E=  入库等于出库

row2(p_50,warehouse_1)..  - VPFW(p_50,plant_1,warehouse_1,road) - VPFW(p_50,plant_1,warehouse_1,rail) - VPFW(p_50,plant_1,warehouse_1,barge) - VPFW(p_50,plant_2,warehouse_1,road) - VPFW(p_50,plant_2,warehouse_1,rail) - VPFW(p_50,plant_2,warehouse_1,barge)
     
      - VPFW(p_50,plant_3,warehouse_1,road) - VPFW(p_50,plant_3,warehouse_1,rail) - VPFW(p_50,plant_3,warehouse_1,barge) + VPWC(p_50,warehouse_1,customer_1,road) + VPWC(p_50,warehouse_1,customer_1,rail) + VPWC(p_50,warehouse_1,customer_1,barge)
     
      + VPWC(p_50,warehouse_1,customer_2,road) + VPWC(p_50,warehouse_1,customer_2,rail) + VPWC(p_50,warehouse_1,customer_2,barge) =E= 0 ; (LHS = 0)
     
row2(p_50,warehouse_2)..  - VPFW(p_50,plant_1,warehouse_2,road) - VPFW(p_50,plant_1,warehouse_2,rail) - VPFW(p_50,plant_1,warehouse_2,barge) - VPFW(p_50,plant_2,warehouse_2,road) - VPFW(p_50,plant_2,warehouse_2,rail) - VPFW(p_50,plant_2,warehouse_2,barge)
     
      - VPFW(p_50,plant_3,warehouse_2,road) - VPFW(p_50,plant_3,warehouse_2,rail) - VPFW(p_50,plant_3,warehouse_2,barge) + VPWC(p_50,warehouse_2,customer_1,road) + VPWC(p_50,warehouse_2,customer_1,rail) + VPWC(p_50,warehouse_2,customer_1,barge)
     
      + VPWC(p_50,warehouse_2,customer_2,road) + VPWC(p_50,warehouse_2,customer_2,rail) + VPWC(p_50,warehouse_2,customer_2,barge) =E= 0 ; (LHS = 0)
     
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                  06/05/18 16:06:14 Page 11
'pvc model for ANOR journal'
Equation Listing    SOLVE supplychain Using EMP From line 383


     row2  =E=  入库等于出库

row2(p_75,warehouse_1)..  - VPFW(p_75,plant_1,warehouse_1,road) - VPFW(p_75,plant_1,warehouse_1,rail) - VPFW(p_75,plant_1,warehouse_1,barge) - VPFW(p_75,plant_2,warehouse_1,road) - VPFW(p_75,plant_2,warehouse_1,rail) - VPFW(p_75,plant_2,warehouse_1,barge)
     
      - VPFW(p_75,plant_3,warehouse_1,road) - VPFW(p_75,plant_3,warehouse_1,rail) - VPFW(p_75,plant_3,warehouse_1,barge) + VPWC(p_75,warehouse_1,customer_1,road) + VPWC(p_75,warehouse_1,customer_1,rail) + VPWC(p_75,warehouse_1,customer_1,barge)
     
      + VPWC(p_75,warehouse_1,customer_2,road) + VPWC(p_75,warehouse_1,customer_2,rail) + VPWC(p_75,warehouse_1,customer_2,barge) =E= 0 ; (LHS = 0)
     
REMAINING 3 ENTRIES SKIPPED


---- row3  =G=  产量大于需求量

row3(p_50)..  VPS(p_50,plant_1) + VPS(p_50,plant_2) + VPS(p_50,plant_3) =G= 45264 ; (LHS = 0, INFES = 45264 ****)
     
row3(p_75)..  VPS(p_75,plant_1) + VPS(p_75,plant_2) + VPS(p_75,plant_3) =G= 59842 ; (LHS = 0, INFES = 59842 ****)
     
row3(p_110)..  VPS(p_110,plant_1) + VPS(p_110,plant_2) + VPS(p_110,plant_3) =G= 24181 ; (LHS = 0, INFES = 24181 ****)
     

---- row4  =G=  对于所有工厂，原材料满足生产

row4(plant_1)..  0.7*VRP(PVC-oil,plant_1) + 0.7*VRP(PVC-calcium,plant_1) - VPS(p_50,plant_1) - VPS(p_75,plant_1) - VPS(p_110,plant_1) =G= 0 ; (LHS = 0)
     
row4(plant_2)..  0.7*VRP(PVC-oil,plant_2) + 0.7*VRP(PVC-calcium,plant_2) - VPS(p_50,plant_2) - VPS(p_75,plant_2) - VPS(p_110,plant_2) =G= 0 ; (LHS = 0)
     
row4(plant_3)..  0.7*VRP(PVC-oil,plant_3) + 0.7*VRP(PVC-calcium,plant_3) - VPS(p_50,plant_3) - VPS(p_75,plant_3) - VPS(p_110,plant_3) =G= 0 ; (LHS = 0)
     

---- row5  =G=  供应商最大产能约束

row5(PVC-oil)..  - VRP(PVC-oil,plant_1) - VRP(PVC-oil,plant_2) - VRP(PVC-oil,plant_3) =G= -90000 ; (LHS = 0)
     
row5(PVC-calcium)..  - VRP(PVC-calcium,plant_1) - VRP(PVC-calcium,plant_2) - VRP(PVC-calcium,plant_3) =G= -120000 ; (LHS = 0)
     

---- row6  =G=  工厂产能约束

row6(plant_1)..  - VPFW(p_50,plant_1,warehouse_1,road) - VPFW(p_50,plant_1,warehouse_1,rail) - VPFW(p_50,plant_1,warehouse_1,barge) - VPFW(p_50,plant_1,warehouse_2,road) - VPFW(p_50,plant_1,warehouse_2,rail) - VPFW(p_50,plant_1,warehouse_2,barge)
     
      - VPFW(p_75,plant_1,warehouse_1,road) - VPFW(p_75,plant_1,warehouse_1,rail) - VPFW(p_75,plant_1,warehouse_1,barge) - VPFW(p_75,plant_1,warehouse_2,road) - VPFW(p_75,plant_1,warehouse_2,rail) - VPFW(p_75,plant_1,warehouse_2,barge)
     
      - VPFW(p_110,plant_1,warehouse_1,road) - VPFW(p_110,plant_1,warehouse_1,rail) - VPFW(p_110,plant_1,warehouse_1,barge) - VPFW(p_110,plant_1,warehouse_2,road) - VPFW(p_110,plant_1,warehouse_2,rail) - VPFW(p_110,plant_1,warehouse_2,barge) =G= -67800 ;
     
      (LHS = 0)
     
row6(plant_2)..  - VPFW(p_50,plant_2,warehouse_1,road) - VPFW(p_50,plant_2,warehouse_1,rail) - VPFW(p_50,plant_2,warehouse_1,barge) - VPFW(p_50,plant_2,warehouse_2,road) - VPFW(p_50,plant_2,warehouse_2,rail) - VPFW(p_50,plant_2,warehouse_2,barge)
     
      - VPFW(p_75,plant_2,warehouse_1,road) - VPFW(p_75,plant_2,warehouse_1,rail) - VPFW(p_75,plant_2,warehouse_1,barge) - VPFW(p_75,plant_2,warehouse_2,road) - VPFW(p_75,plant_2,warehouse_2,rail) - VPFW(p_75,plant_2,warehouse_2,barge)
     
      - VPFW(p_110,plant_2,warehouse_1,road) - VPFW(p_110,plant_2,warehouse_1,rail) - VPFW(p_110,plant_2,warehouse_1,barge) - VPFW(p_110,plant_2,warehouse_2,road) - VPFW(p_110,plant_2,warehouse_2,rail) - VPFW(p_110,plant_2,warehouse_2,barge) =G= -85000 ;
     
      (LHS = 0)
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                  06/05/18 16:06:14 Page 12
'pvc model for ANOR journal'
Equation Listing    SOLVE supplychain Using EMP From line 383


     row6  =G=  工厂产能约束

row6(plant_3)..  - VPFW(p_50,plant_3,warehouse_1,road) - VPFW(p_50,plant_3,warehouse_1,rail) - VPFW(p_50,plant_3,warehouse_1,barge) - VPFW(p_50,plant_3,warehouse_2,road) - VPFW(p_50,plant_3,warehouse_2,rail) - VPFW(p_50,plant_3,warehouse_2,barge)
     
      - VPFW(p_75,plant_3,warehouse_1,road) - VPFW(p_75,plant_3,warehouse_1,rail) - VPFW(p_75,plant_3,warehouse_1,barge) - VPFW(p_75,plant_3,warehouse_2,road) - VPFW(p_75,plant_3,warehouse_2,rail) - VPFW(p_75,plant_3,warehouse_2,barge)
     
      - VPFW(p_110,plant_3,warehouse_1,road) - VPFW(p_110,plant_3,warehouse_1,rail) - VPFW(p_110,plant_3,warehouse_1,barge) - VPFW(p_110,plant_3,warehouse_2,road) - VPFW(p_110,plant_3,warehouse_2,rail) - VPFW(p_110,plant_3,warehouse_2,barge) =G= -42500 ;
     
      (LHS = 0)
     

---- row7  =G=  仓库容量约束

row7(warehouse_1)..  - VPFW(p_50,plant_1,warehouse_1,road) - VPFW(p_50,plant_1,warehouse_1,rail) - VPFW(p_50,plant_1,warehouse_1,barge) - VPFW(p_50,plant_2,warehouse_1,road) - VPFW(p_50,plant_2,warehouse_1,rail) - VPFW(p_50,plant_2,warehouse_1,barge)
     
      - VPFW(p_50,plant_3,warehouse_1,road) - VPFW(p_50,plant_3,warehouse_1,rail) - VPFW(p_50,plant_3,warehouse_1,barge) - VPFW(p_75,plant_1,warehouse_1,road) - VPFW(p_75,plant_1,warehouse_1,rail) - VPFW(p_75,plant_1,warehouse_1,barge)
     
      - VPFW(p_75,plant_2,warehouse_1,road) - VPFW(p_75,plant_2,warehouse_1,rail) - VPFW(p_75,plant_2,warehouse_1,barge) - VPFW(p_75,plant_3,warehouse_1,road) - VPFW(p_75,plant_3,warehouse_1,rail) - VPFW(p_75,plant_3,warehouse_1,barge)
     
      - VPFW(p_110,plant_1,warehouse_1,road) - VPFW(p_110,plant_1,warehouse_1,rail) - VPFW(p_110,plant_1,warehouse_1,barge) - VPFW(p_110,plant_2,warehouse_1,road) - VPFW(p_110,plant_2,warehouse_1,rail) - VPFW(p_110,plant_2,warehouse_1,barge)
     
      - VPFW(p_110,plant_3,warehouse_1,road) - VPFW(p_110,plant_3,warehouse_1,rail) - VPFW(p_110,plant_3,warehouse_1,barge) =G= -60000 ; (LHS = 0)
     
row7(warehouse_2)..  - VPFW(p_50,plant_1,warehouse_2,road) - VPFW(p_50,plant_1,warehouse_2,rail) - VPFW(p_50,plant_1,warehouse_2,barge) - VPFW(p_50,plant_2,warehouse_2,road) - VPFW(p_50,plant_2,warehouse_2,rail) - VPFW(p_50,plant_2,warehouse_2,barge)
     
      - VPFW(p_50,plant_3,warehouse_2,road) - VPFW(p_50,plant_3,warehouse_2,rail) - VPFW(p_50,plant_3,warehouse_2,barge) - VPFW(p_75,plant_1,warehouse_2,road) - VPFW(p_75,plant_1,warehouse_2,rail) - VPFW(p_75,plant_1,warehouse_2,barge)
     
      - VPFW(p_75,plant_2,warehouse_2,road) - VPFW(p_75,plant_2,warehouse_2,rail) - VPFW(p_75,plant_2,warehouse_2,barge) - VPFW(p_75,plant_3,warehouse_2,road) - VPFW(p_75,plant_3,warehouse_2,rail) - VPFW(p_75,plant_3,warehouse_2,barge)
     
      - VPFW(p_110,plant_1,warehouse_2,road) - VPFW(p_110,plant_1,warehouse_2,rail) - VPFW(p_110,plant_1,warehouse_2,barge) - VPFW(p_110,plant_2,warehouse_2,road) - VPFW(p_110,plant_2,warehouse_2,rail) - VPFW(p_110,plant_2,warehouse_2,barge)
     
      - VPFW(p_110,plant_3,warehouse_2,road) - VPFW(p_110,plant_3,warehouse_2,rail) - VPFW(p_110,plant_3,warehouse_2,barge) =G= -80000 ; (LHS = 0)
     
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                  06/05/18 16:06:14 Page 13
'pvc model for ANOR journal'
Column Listing      SOLVE supplychain Using EMP From line 383


---- VRP  amount of raw material (tons) purchased from supplier s in plant f

VRP(PVC-oil,plant_1)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
    (-190)      suppliercost
    -7100       plantcost
        0.7     row4(plant_1)
       -1       row5(PVC-oil)

VRP(PVC-oil,plant_2)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
    (-190)      suppliercost
    -7100       plantcost
        0.7     row4(plant_2)
       -1       row5(PVC-oil)

VRP(PVC-oil,plant_3)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
    (-190)      suppliercost
    -7100       plantcost
        0.7     row4(plant_3)
       -1       row5(PVC-oil)

REMAINING 3 ENTRIES SKIPPED

---- VRSF  amount of raw material (tons) shipped from supplier s to  plant f with transport mode t

VRSF(PVC-oil,plant_1,road)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
    (-161.1)    suppliercost

VRSF(PVC-oil,plant_1,rail)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
     (-92.1)    suppliercost

VRSF(PVC-oil,plant_1,barge)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
    (-156.6)    suppliercost

REMAINING 15 ENTRIES SKIPPED

---- VPFW  amount of product p (tons) shipped from plant f to warehouse w with transport mode t

VPFW(p_50,plant_1,warehouse_1,road)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
    (-831.4)    plantcost
       -1       row2(p_50,warehouse_1)
       -1       row6(plant_1)
       -1       row7(warehouse_1)

VPFW(p_50,plant_1,warehouse_1,rail)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
    (-797.05)   plantcost
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                  06/05/18 16:06:14 Page 14
'pvc model for ANOR journal'
Column Listing      SOLVE supplychain Using EMP From line 383


     VPFW  amount of product p (tons) shipped from plant f to warehouse w with transport mode t

       -1       row2(p_50,warehouse_1)
       -1       row6(plant_1)
       -1       row7(warehouse_1)

VPFW(p_50,plant_1,warehouse_1,barge)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
    (-777)      plantcost
       -1       row2(p_50,warehouse_1)
       -1       row6(plant_1)
       -1       row7(warehouse_1)

REMAINING 51 ENTRIES SKIPPED

---- VPWC  amount of product p (tons) shipped from warehouse w  to customer c with transport mode t

VPWC(p_50,warehouse_1,customer_1,road)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
     (-71.7)    plantcost
       -1       row1(customer_1,p_50)
        1       row2(p_50,warehouse_1)

VPWC(p_50,warehouse_1,customer_1,rail)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
    (-100.05)   plantcost
       -1       row1(customer_1,p_50)
        1       row2(p_50,warehouse_1)

VPWC(p_50,warehouse_1,customer_1,barge)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
    (-128.4)    plantcost
       -1       row1(customer_1,p_50)
        1       row2(p_50,warehouse_1)

REMAINING 33 ENTRIES SKIPPED

---- VPS  amount of product p (tons) produced from plant f

VPS(p_50,plant_1)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
    (-700.025)  plantcost
   -11168       income
        1       row3(p_50)
       -1       row4(plant_1)

VPS(p_50,plant_2)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
    (-700.025)  plantcost
   -11168       income
        1       row3(p_50)
       -1       row4(plant_2)

GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                  06/05/18 16:06:14 Page 15
'pvc model for ANOR journal'
Column Listing      SOLVE supplychain Using EMP From line 383


     VPS  amount of product p (tons) produced from plant f

VPS(p_50,plant_3)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
    (-700.025)  plantcost
   -11168       income
        1       row3(p_50)
       -1       row4(plant_3)

REMAINING 6 ENTRIES SKIPPED

---- z  overall costs

z
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       cost


---- sc  cost of suppliers

sc
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
       -1       cost
        1       suppliercost


---- pc  cost of plants

pc
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
       -1       cost
        1       plantcost
        1       profit


---- pf  profit of plants

pf
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       profit


---- icm  income

icm
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       income
       -1       profit

GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                  06/05/18 16:06:14 Page 16
'pvc model for ANOR journal'
Column Listing      SOLVE supplychain Using EMP From line 383


---- cp_var  

cp_var
                (.LO, .L, .UP, .M = -INF, 100, +INF, 0)
       (0)      suppliercost
       (0)      plantcost

GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                  06/05/18 16:06:14 Page 17
'pvc model for ANOR journal'
Model Statistics    SOLVE supplychain Using EMP From line 383


MODEL STATISTICS

BLOCKS OF EQUATIONS          12     SINGLE EQUATIONS           30
BLOCKS OF VARIABLES          11     SINGLE VARIABLES          129
NON ZERO ELEMENTS           413     NON LINEAR N-Z            125
DERIVATIVE POOL              20     CONSTANT POOL              96
CODE LENGTH                 730


GENERATION TIME      =        0.008 SECONDS      4 MB  24.9.2 r64480 DEX-DEG


EXECUTION TIME       =        0.010 SECONDS      4 MB  24.9.2 r64480 DEX-DEG
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                  06/05/18 16:06:14 Page 18
'pvc model for ANOR journal'
Solution Report     SOLVE supplychain Using EMP From line 383


               S O L V E      S U M M A R Y

     MODEL   supplychain         OBJECTIVE  z
     TYPE    EMP                 DIRECTION  MINIMIZE
     SOLVER  JAMS                FROM LINE  383

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      4 Infeasible                
**** OBJECTIVE VALUE       1493410151.7837

 RESOURCE USAGE, LIMIT          0.008      1000.000
 ITERATION COUNT, LIMIT        17    2000000000
 EVALUATION ERRORS              0             0
--- Input model type identified and solved as LP
DE               24.9.2 r64480 Released Nov 14, 2017 DEG x86 64bit/Mac OS X   
--- DE has 56 rows 140 columns 1165 non-zeroes

IBM ILOG CPLEX   24.9.2 r64480 Released Nov 14, 2017 DEG x86 64bit/Mac OS X   
Cplex 12.7.1.0

Unable to load names.
LP status(3): infeasible
Cplex Time: 0.00sec (det. 0.31 ticks)
Model has been proven infeasible.

                           LOWER          LEVEL          UPPER         MARGINAL

---- EQU cost                .              .              .             0.1667      
---- EQU supplierc~          .              .              .             0.1667      
---- EQU plantcost    2.6262500E+7   2.6294797E+7   2.6262500E+7         0.1667      
---- EQU income              .              .              .             EPS         
---- EQU profit              .              .              .             EPS         

  cost  objective function
  suppliercost  供应商成本由  2 7 10 组成
  plantcost  工厂成本由   1  3 4 5 6 8 9 11 12 组成
  income  销售收入
  profit  profit of plants

---- EQU row1  仓库运输到客户的产品量必须等于客户需求量 （假设Just in Time 库存模式）

                        LOWER          LEVEL          UPPER         MARGINAL

customer_1.p_50     -19680.0000    -19680.0000    -19680.0000       -71.2020      
customer_1.p_75     -34524.0000    -34524.0000    -34524.0000      -762.9685      
customer_1.p_110    -14095.0000    -14095.0000    -14095.0000       -71.2020      
customer_2.p_50     -25584.0000    -25584.0000    -25584.0000      -106.8030      
customer_2.p_75     -25318.0000    -25318.0000    -25318.0000      -798.5695      
customer_2.p_110    -10086.0000    -10086.0000    -10086.0000      -106.8030      
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                  06/05/18 16:06:14 Page 19
'pvc model for ANOR journal'
Solution Report     SOLVE supplychain Using EMP From line 383


---- EQU row2  入库等于出库

                         LOWER          LEVEL          UPPER         MARGINAL

p_50 .warehouse_1          .         45264.0000          .              .     INFES
p_50 .warehouse_2          .              .              .             7.1202      
p_75 .warehouse_1          .              .              .          -691.7665      
p_75 .warehouse_2          .              .              .          -684.6463      
p_110.warehouse_1          .         24181.0000          .              .     INFES
p_110.warehouse_2          .              .              .              .          

---- EQU row3  产量大于需求量

             LOWER          LEVEL          UPPER         MARGINAL

p_50      45264.0000     45264.0000        +INF        10939.8031      
p_75      59842.0000     59842.0000        +INF        10939.8023      
p_110     24181.0000     24181.0000        +INF        10939.8014      

---- EQU row4  对于所有工厂，原材料满足生产

               LOWER          LEVEL          UPPER         MARGINAL

plant_1          .              .            +INF        10239.7959      
plant_2          .              .            +INF        10239.7959      
plant_3          .              .            +INF        10239.7959      

---- EQU row5  供应商最大产能约束

                   LOWER          LEVEL          UPPER         MARGINAL

PVC-oil        -90000.0000   -247360.3316        +INF             .     INFES
PVC-calcium   -120000.0000     62664.6173        +INF             .          

---- EQU row6  工厂产能约束

               LOWER          LEVEL          UPPER         MARGINAL

plant_1    -67800.0000          .            +INF             .          
plant_2    -85000.0000          .            +INF             .          
plant_3    -42500.0000    -59842.0000        +INF             .     INFES

---- EQU row7  仓库容量约束

                   LOWER          LEVEL          UPPER         MARGINAL

warehouse_1    -60000.0000          .            +INF             .          
warehouse_2    -80000.0000    -59842.0000        +INF             .          
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                  06/05/18 16:06:14 Page 20
'pvc model for ANOR journal'
Solution Report     SOLVE supplychain Using EMP From line 383


---- VAR VRP  amount of raw material (tons) purchased from supplier s in plant f

                           LOWER          LEVEL          UPPER         MARGINAL

PVC-oil    .plant_1          .        247360.3316        +INF             .          
PVC-oil    .plant_2          .              .            +INF            EPS         
PVC-oil    .plant_3          .              .            +INF            EPS         
PVC-calcium.plant_1          .        -62664.6173        +INF             .     INFES
PVC-calcium.plant_2          .              .            +INF            EPS         
PVC-calcium.plant_3          .              .            +INF            EPS         

---- VAR VRSF  amount of raw material (tons) shipped from supplier s to  plant f with transport mode t

                                 LOWER          LEVEL          UPPER         MARGINAL

PVC-oil    .plant_1.road           .              .            +INF          159.7500      
PVC-oil    .plant_1.rail           .              .            +INF           90.7500      
PVC-oil    .plant_1.barge          .              .            +INF          154.2857      
PVC-oil    .plant_2.road           .              .            +INF          213.0000      
PVC-oil    .plant_2.rail           .              .            +INF          121.0000      
PVC-oil    .plant_2.barge          .              .            +INF          205.7143      
PVC-oil    .plant_3.road           .              .            +INF          266.2500      
PVC-oil    .plant_3.rail           .              .            +INF          151.2500      
PVC-oil    .plant_3.barge          .              .            +INF          257.1429      
PVC-calcium.plant_1.road           .              .            +INF          213.0000      
PVC-calcium.plant_1.rail           .              .            +INF          121.0000      
PVC-calcium.plant_1.barge          .              .            +INF          205.7143      
PVC-calcium.plant_2.road           .              .            +INF          266.2500      
PVC-calcium.plant_2.rail           .              .            +INF          151.2500      
PVC-calcium.plant_2.barge          .              .            +INF          257.1429      
PVC-calcium.plant_3.road           .              .            +INF          319.5000      
PVC-calcium.plant_3.rail           .              .            +INF          181.5000      
PVC-calcium.plant_3.barge          .              .            +INF          308.5714      

---- VAR VPFW  amount of product p (tons) shipped from plant f to warehouse w with transport mode t

                                       LOWER          LEVEL          UPPER         MARGINAL

p_50 .plant_1.warehouse_1.road           .              .            +INF          830.4040      
p_50 .plant_1.warehouse_1.rail           .              .            +INF          796.3030      
p_50 .plant_1.warehouse_1.barge          .              .            +INF          775.5771      
p_50 .plant_1.warehouse_2.road           .              .            +INF          802.7262      
p_50 .plant_1.warehouse_2.rail           .              .            +INF          735.5242      
p_50 .plant_1.warehouse_2.barge          .              .            +INF          697.8127      
p_50 .plant_2.warehouse_1.road           .              .            +INF          836.9242      
p_50 .plant_2.warehouse_1.rail           .              .            +INF          799.5131      
p_50 .plant_2.warehouse_1.barge          .              .            +INF          777.0886      
p_50 .plant_2.warehouse_2.road           .              .            +INF          809.2463      
p_50 .plant_2.warehouse_2.rail           .              .            +INF          738.7343      
p_50 .plant_2.warehouse_2.barge          .              .            +INF          699.3243      
p_50 .plant_3.warehouse_1.road           .              .            +INF          843.4444      
p_50 .plant_3.warehouse_1.rail           .              .            +INF          809.1434      
p_50 .plant_3.warehouse_1.barge          .              .            +INF          781.6233      
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                  06/05/18 16:06:14 Page 21
'pvc model for ANOR journal'
Solution Report     SOLVE supplychain Using EMP From line 383


     VAR VPFW  amount of product p (tons) shipped from plant f to warehouse w with transport mode t

                                       LOWER          LEVEL          UPPER         MARGINAL

p_50 .plant_3.warehouse_2.road           .              .            +INF          763.6050      
p_50 .plant_3.warehouse_2.rail           .              .            +INF          722.6838      
p_50 .plant_3.warehouse_2.barge          .              .            +INF          691.7665      
p_75 .plant_1.warehouse_1.road           .              .            +INF          138.6374      
p_75 .plant_1.warehouse_1.rail           .              .            +INF          104.5364      
p_75 .plant_1.warehouse_1.barge          .              .            +INF           83.8105      
p_75 .plant_1.warehouse_2.road           .              .            +INF          110.9596      
p_75 .plant_1.warehouse_2.rail           .              .            +INF           43.7576      
p_75 .plant_1.warehouse_2.barge          .              .            +INF            6.0462      
p_75 .plant_2.warehouse_1.road           .              .            +INF          145.1576      
p_75 .plant_2.warehouse_1.rail           .              .            +INF          107.7465      
p_75 .plant_2.warehouse_1.barge          .              .            +INF           85.3221      
p_75 .plant_2.warehouse_2.road           .              .            +INF          117.4798      
p_75 .plant_2.warehouse_2.rail           .              .            +INF           46.9677      
p_75 .plant_2.warehouse_2.barge          .              .            +INF            7.5577      
p_75 .plant_3.warehouse_1.road           .              .            +INF          151.6778      
p_75 .plant_3.warehouse_1.rail           .              .            +INF          117.3768      
p_75 .plant_3.warehouse_1.barge          .              .            +INF           89.8567      
p_75 .plant_3.warehouse_2.road           .              .            +INF           71.8384      
p_75 .plant_3.warehouse_2.rail           .              .            +INF           30.9172      
p_75 .plant_3.warehouse_2.barge          .         59842.0000        +INF             .          
p_110.plant_1.warehouse_1.road           .              .            +INF          830.4040      
p_110.plant_1.warehouse_1.rail           .              .            +INF          796.3030      
p_110.plant_1.warehouse_1.barge          .              .            +INF          775.5771      
p_110.plant_1.warehouse_2.road           .              .            +INF          795.6060      
p_110.plant_1.warehouse_2.rail           .              .            +INF          728.4040      
p_110.plant_1.warehouse_2.barge          .              .            +INF          690.6925      
p_110.plant_2.warehouse_1.road           .              .            +INF          836.9242      
p_110.plant_2.warehouse_1.rail           .              .            +INF          799.5131      
p_110.plant_2.warehouse_1.barge          .              .            +INF          777.0886      
p_110.plant_2.warehouse_2.road           .              .            +INF          802.1262      
p_110.plant_2.warehouse_2.rail           .              .            +INF          731.6141      
p_110.plant_2.warehouse_2.barge          .              .            +INF          692.2041      
p_110.plant_3.warehouse_1.road           .              .            +INF          843.4444      
p_110.plant_3.warehouse_1.rail           .              .            +INF          809.1434      
p_110.plant_3.warehouse_1.barge          .              .            +INF          781.6233      
p_110.plant_3.warehouse_2.road           .              .            +INF          756.4848      
p_110.plant_3.warehouse_2.rail           .              .            +INF          715.5636      
p_110.plant_3.warehouse_2.barge          .              .            +INF          684.6463      

---- VAR VPWC  amount of product p (tons) shipped from warehouse w  to customer c with transport mode t

                                          LOWER          LEVEL          UPPER         MARGINAL

p_50 .warehouse_1.customer_1.road           .         45264.0000        +INF             .          
p_50 .warehouse_1.customer_1.rail           .              .            +INF           28.1010      
p_50 .warehouse_1.customer_1.barge          .              .            +INF           55.4905      
p_50 .warehouse_1.customer_2.road           .              .            +INF            EPS         
p_50 .warehouse_1.customer_2.rail           .              .            +INF           42.1515      
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                  06/05/18 16:06:14 Page 22
'pvc model for ANOR journal'
Solution Report     SOLVE supplychain Using EMP From line 383


     VAR VPWC  amount of product p (tons) shipped from warehouse w  to customer c with transport mode t

                                          LOWER          LEVEL          UPPER         MARGINAL

p_50 .warehouse_1.customer_2.barge          .              .            +INF           83.2358      
p_50 .warehouse_2.customer_1.road           .        -25584.0000        +INF             .     INFES
p_50 .warehouse_2.customer_1.rail           .              .            +INF           30.9111      
p_50 .warehouse_2.customer_1.barge          .              .            +INF           61.0396      
p_50 .warehouse_2.customer_2.road           .         25584.0000        +INF             .          
p_50 .warehouse_2.customer_2.rail           .              .            +INF           51.5818      
p_50 .warehouse_2.customer_2.barge          .              .            +INF           97.2310      
p_75 .warehouse_1.customer_1.road           .              .            +INF             .          
p_75 .warehouse_1.customer_1.rail           .              .            +INF           28.1010      
p_75 .warehouse_1.customer_1.barge          .              .            +INF           55.4905      
p_75 .warehouse_1.customer_2.road           .              .            +INF            EPS         
p_75 .warehouse_1.customer_2.rail           .              .            +INF           42.1515      
p_75 .warehouse_1.customer_2.barge          .              .            +INF           83.2358      
p_75 .warehouse_2.customer_1.road           .         34524.0000        +INF             .          
p_75 .warehouse_2.customer_1.rail           .              .            +INF           30.9111      
p_75 .warehouse_2.customer_1.barge          .              .            +INF           61.0396      
p_75 .warehouse_2.customer_2.road           .         25318.0000        +INF             .          
p_75 .warehouse_2.customer_2.rail           .              .            +INF           51.5818      
p_75 .warehouse_2.customer_2.barge          .              .            +INF           97.2310      
p_110.warehouse_1.customer_1.road           .         14095.0000        +INF             .          
p_110.warehouse_1.customer_1.rail           .              .            +INF           28.1010      
p_110.warehouse_1.customer_1.barge          .              .            +INF           55.4905      
p_110.warehouse_1.customer_2.road           .         10086.0000        +INF             .          
p_110.warehouse_1.customer_2.rail           .              .            +INF           42.1515      
p_110.warehouse_1.customer_2.barge          .              .            +INF           83.2358      
p_110.warehouse_2.customer_1.road           .              .            +INF            7.1202      
p_110.warehouse_2.customer_1.rail           .              .            +INF           38.0313      
p_110.warehouse_2.customer_1.barge          .              .            +INF           68.1598      
p_110.warehouse_2.customer_2.road           .              .            +INF            7.1202      
p_110.warehouse_2.customer_2.rail           .              .            +INF           58.7020      
p_110.warehouse_2.customer_2.barge          .              .            +INF          104.3512      

---- VAR VPS  amount of product p (tons) produced from plant f

                     LOWER          LEVEL          UPPER         MARGINAL

p_50 .plant_1          .         45264.0000        +INF             .          
p_50 .plant_2          .              .            +INF             .          
p_50 .plant_3          .              .            +INF             .          
p_75 .plant_1          .         59842.0000        +INF             .          
p_75 .plant_2          .              .            +INF            EPS         
p_75 .plant_3          .              .            +INF            EPS         
p_110.plant_1          .         24181.0000        +INF             .          
p_110.plant_2          .              .            +INF            EPS         
p_110.plant_3          .              .            +INF            EPS         
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                  06/05/18 16:06:14 Page 23
'pvc model for ANOR journal'
Solution Report     SOLVE supplychain Using EMP From line 383


                           LOWER          LEVEL          UPPER         MARGINAL

---- VAR z                 -INF      1.4934102E+9        +INF             .          
---- VAR sc                -INF      -1.047994E-9        +INF             .          
---- VAR pc                -INF      1.4934102E+9        +INF             .          
---- VAR pf                -INF      -1.608283E+8        +INF             .          
---- VAR icm               -INF      1.3325819E+9        +INF             .          
---- VAR cp_var            -INF             .            +INF            EPS     NOPT

  z  overall costs
  sc  cost of suppliers
  pc  cost of plants
  pf  profit of plants
  icm  income


**** REPORT SUMMARY :        1     NONOPT ( NOPT)
                             6 INFEASIBLE (INFES)
                    SUM     332395.9490
                    MAX     157360.3316
                    MEAN     55399.3248
                             0  UNBOUNDED
                             0     ERRORS
                             1  PROJECTED
GAMS 24.9.2  r64480 Released Nov 14, 2017 DEX-DEG x86 64bit/Mac OS X                                                                                                                                                                  06/05/18 16:06:14 Page 24
'pvc model for ANOR journal'
E x e c u t i o n


----    385 PARAMETER s_cp  

s1  3.212,    s2 22.091,    s3 18.677,    s4 28.855,    s5  8.907,    s6 14.789


----    385 PARAMETER s_z  

s1 1.493410E+9,    s2 1.493410E+9,    s3 1.493410E+9,    s4 1.493410E+9,    s5 1.493410E+9,    s6 1.493410E+9


----    385 PARAMETER s_pf  

s1 -1.60828E+8,    s2 -1.60828E+8,    s3 -1.60828E+8,    s4 -1.60828E+8,    s5 -1.60828E+8,    s6 -1.60828E+8


----    385 PARAMETER s_o  scenario probability

          prob

s1       0.167
s2       0.167
s3       0.167
s4       0.167
s5       0.167
s6       0.167


**** REPORT FILE SUMMARY

emp /Users/renhongtao/gamsmodel/pvc/pvc/225a/empinfo.dat


EXECUTION TIME       =        0.010 SECONDS      4 MB  24.9.2 r64480 DEX-DEG


USER: Small MUD - 5 User License Generic             S160905:1044AO-GEN
      IIASA, Information and Communication Technologies Dep.      DC216
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      /Users/renhongtao/gamsmodel/pvc/pvc/supplychain_sto.gms
Output     /Users/renhongtao/gamsmodel/pvc/pvc/supplychain_sto.lst
